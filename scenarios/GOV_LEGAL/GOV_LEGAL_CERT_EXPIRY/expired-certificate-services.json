{
	"id": "expired-certificate-services",
	"title": "Resposta a Expira√ß√£o de Certificado Digital em Servi√ßos Cr√≠ticos",
	"description": "Simula√ß√£o tabletop de resposta a incidente causado por expira√ß√£o de certificado SSL/TLS em m√∫ltiplos servi√ßos corporativos",
	"category": {
		"id": "GOV_LEGAL",
		"type": "GOV_LEGAL_CERT_EXPIRY",
		"title": "Expira√ß√£o de Certificado Digital"
	},
	"metadata": {
		"version": "1.0",
		"lastUpdate": "2025-02-02",
		"author": "Lucas Rayan Guerra",
		"estimatedDuration": "35-50 minutos",
		"difficulty": "Intermedi√°rio",
		"targetAudience": "Equipe de Infraestrutura, Administradores de Sistemas, Analistas de Seguran√ßa, Gestores de TI"
	},
	"objectives": [
		"Validar capacidade de detec√ß√£o e resposta r√°pida a expira√ß√£o de certificados digitais",
		"Avaliar conhecimento sobre PKI (Public Key Infrastructure), CA (Certificate Authority) e processos de renova√ß√£o",
		"Testar procedimentos de renova√ß√£o emergencial e gest√£o de certificados",
		"Desenvolver compreens√£o de impactos operacionais e de seguran√ßa da expira√ß√£o de certificados",
		"Identificar processos de invent√°rio, monitoramento proativo e alertas de expira√ß√£o",
		"Promover conhecimento sobre diferentes tipos de certificados (DV, OV, EV, wildcard, SAN)"
	],
	"scope": [
		"Exerc√≠cio de simula√ß√£o tabletop - n√£o haver√° execu√ß√£o real de comandos em sistemas de produ√ß√£o",
		"N√£o inclui compra ou emiss√£o real de certificados junto a CAs comerciais",
		"Foco na an√°lise t√©cnica, tomada de decis√£o e procedimentos de resposta emergencial",
		"Avalia√ß√£o de conhecimento de PKI, TLS/SSL e gest√£o de certificados digitais"
	],
	"baseScenario": {
		"context": "Segunda-feira, 8h15, in√≠cio do expediente. Voc√™ faz parte da equipe de infraestrutura. A organiza√ß√£o opera diversos servi√ßos cr√≠ticos protegidos por certificados SSL/TLS: portal web principal (HTTPS), API de integra√ß√£o externa, servidor de e-mail (SMTP/IMAP com TLS), VPN SSL corporativa, e sistema de autentica√ß√£o federada (SAML). Todos os certificados s√£o emitidos por CA comercial confi√°vel (n√£o autoassinados). O processo de renova√ß√£o √© manual, dependendo de solicita√ß√£o via portal da CA e instala√ß√£o nos servidores.",
		"initialSituation": {
			"alert": "M√∫ltiplos usu√°rios reportam erros de certificado ao acessar portal web",
			"affectedServices": "Portal web principal (portal.company.com)",
			"errorMessage": "NET::ERR_CERT_DATE_INVALID - Certificate has expired",
			"certificateExpiry": "2025-02-02 07:59:00 UTC (expirado h√° 15 minutos)",
			"timestamp": "08:14:22"
		},
		"initialComplaints": [
			"Navegadores exibem aviso de seguran√ßa: 'Sua conex√£o n√£o √© particular'",
			"Alguns usu√°rios receberam e-mail de alerta da CA h√° 30 dias, mas foi ignorado",
			"Clientes externos reportam impossibilidade de acessar portal de autoatendimento",
			"Equipe comercial n√£o consegue acessar sistema de CRM hospedado no mesmo dom√≠nio"
		],
		"availableResources": [
			"Acesso administrativo aos servidores web (Apache, Nginx, IIS)",
			"Conta ativa no portal da Certificate Authority (CA)",
			"Ferramentas de an√°lise: openssl, certutil, nmap com ssl-enum-ciphers",
			"Documenta√ß√£o de procedimentos de renova√ß√£o de certificados (parcialmente desatualizada)",
			"Acesso ao DNS para valida√ß√£o de dom√≠nio (m√©todo HTTP-01 ou DNS-01)",
			"Backup de chaves privadas em cofre seguro",
			"Sistema de monitoramento (Zabbix, Nagios) sem checks de expira√ß√£o configurados"
		]
	},
	"rounds": [
		{
			"id": 1,
			"title": "Prepara√ß√£o e Contextualiza√ß√£o",
			"phase": "Prepara√ß√£o",
			"description": "Apresenta√ß√£o do cen√°rio base. A equipe deve se familiarizar com a situa√ß√£o inicial e infraestrutura de certificados.",
			"inject": "Apresenta√ß√£o do cen√°rio conforme descrito. A equipe tem 5 minutos para discutir a situa√ß√£o inicial e planejar abordagem.",
			"questions": []
		},
		{
			"id": 2,
			"title": "Detec√ß√£o e An√°lise Inicial",
			"phase": "Fase 1 - Detec√ß√£o e An√°lise",
			"description": "A equipe investiga os erros reportados e executa an√°lise do certificado para confirmar expira√ß√£o e avaliar escopo do problema.",
			"timeElapsed": "T+0 (in√≠cio do incidente - 08:14)",
			"currentSituation": {
				"webPortalAvailability": "Indispon√≠vel para navegadores (erro de certificado)",
				"userImpact": "~300 usu√°rios internos + clientes externos",
				"businessImpact": "Portal de autoatendimento e CRM inacess√≠veis",
				"otherServices": "Status desconhecido - requer verifica√ß√£o"
			},
			"metrics": [
				{
					"type": "certificate-analysis",
					"title": "An√°lise do Certificado Expirado (portal.company.com)",
					"data": {
						"subject": "CN=portal.company.com",
						"issuer": "CN=Sectigo RSA Domain Validation Secure Server CA, O=Sectigo Limited, C=GB",
						"validFrom": "2024-02-02 00:00:00 UTC",
						"validTo": "2025-02-02 07:59:00 UTC (EXPIRADO)",
						"serialNumber": "00d1a9b8c7f6e5d4c3b2a19080706050",
						"signatureAlgorithm": "SHA256-RSA",
						"publicKeyAlgorithm": "RSA 2048 bits",
						"san": ["DNS:portal.company.com", "DNS:www.portal.company.com"],
						"certificateType": "DV (Domain Validation)",
						"observation": "Certificado expirou h√° 15 minutos. N√£o √© wildcard (cobre apenas portal.company.com e www). CA enviou 3 alertas: 90 dias, 30 dias e 7 dias antes da expira√ß√£o para admin@company.com (caixa de e-mail compartilhada raramente checada)."
					}
				},
				{
					"type": "browser-errors",
					"title": "Erros Reportados pelos Navegadores",
					"data": {
						"chrome": "NET::ERR_CERT_DATE_INVALID - Certificado expirado",
						"firefox": "SEC_ERROR_EXPIRED_CERTIFICATE - O certificado expirou",
						"edge": "DLG_FLAGS_INVALID_CA - Certificado n√£o √© confi√°vel",
						"curl": "curl: (60) SSL certificate problem: certificate has expired",
						"observation": "Todos os navegadores modernos bloqueiam acesso a sites com certificados expirados. Usu√°rios podem clicar em 'Avan√ßado' e 'Continuar mesmo assim', mas isso exp√µe a riscos de seguran√ßa e n√£o √© aceit√°vel para ambiente corporativo."
					}
				},
				{
					"type": "services-inventory",
					"title": "Invent√°rio de Certificados - Outros Servi√ßos",
					"data": {
						"api.company.com": "V√°lido at√© 2025-08-15 (6 meses restantes) ‚úÖ",
						"mail.company.com": "V√°lido at√© 2025-02-09 (7 dias restantes) ‚ö†Ô∏è",
						"vpn.company.com": "V√°lido at√© 2025-02-05 (3 dias restantes) üî¥",
						"auth.company.com": "V√°lido at√© 2025-04-20 (2.5 meses restantes) ‚úÖ",
						"observation": "CR√çTICO: Al√©m do portal.company.com j√° expirado, VPN e e-mail expirar√£o em 3 e 7 dias respectivamente. Falta de processo de monitoramento proativo resultou em m√∫ltiplas renova√ß√µes atrasadas."
					}
				}
			],
			"questions": [
				{
					"id": "q1",
					"type": "multiple-choice",
					"question": "Com base nas evid√™ncias fornecidas, qual √© a causa raiz mais prov√°vel da expira√ß√£o do certificado?",
					"points": 5,
					"options": [
						"Falha t√©cnica do servidor web que impediu a renova√ß√£o autom√°tica",
						"Processo manual de renova√ß√£o sem monitoramento proativo e alertas ignorados",
						"Ataque cibern√©tico que corrompeu o arquivo do certificado",
						"Erro da Certificate Authority que emitiu certificado com validade incorreta"
					],
					"correctAnswer": 1,
					"justification": "A causa raiz √© processo manual sem monitoramento (B). A CA enviou 3 alertas (90, 30 e 7 dias) para admin@company.com, mas foram ignorados. N√£o h√° indica√ß√£o de renova√ß√£o autom√°tica configurada. (A) √© incorreta pois renova√ß√£o √© manual. (C) √© implaus√≠vel - ataque n√£o causaria expira√ß√£o temporal programada. (D) √© incorreta - certificado teve validade normal de 1 ano (fev/2024 a fev/2025)."
				},
				{
					"id": "q2",
					"type": "true-false",
					"question": "Certificados DV (Domain Validation) podem ser emitidos imediatamente ap√≥s valida√ß√£o via DNS ou HTTP, sem necessidade de valida√ß√£o organizacional ou documenta√ß√£o legal.",
					"points": 3,
					"correctAnswer": true,
					"justification": "VERDADEIRO. Certificados DV (Domain Validation) validam apenas que o solicitante controla o dom√≠nio, atrav√©s de m√©todos automatizados como HTTP-01 (arquivo em /.well-known/acme-challenge/), DNS-01 (registro TXT DNS) ou e-mail para admin@dominio. N√£o requerem valida√ß√£o organizacional (OV) ou jur√≠dica (EV), permitindo emiss√£o em minutos. Ideal para resposta r√°pida em emerg√™ncias, mas oferecem menor n√≠vel de confian√ßa que OV/EV."
				},
				{
					"id": "q3",
					"type": "multiple-choice",
					"question": "Qual √© a a√ß√£o de conten√ß√£o imediata mais apropriada para restaurar o acesso ao portal enquanto aguarda emiss√£o do novo certificado?",
					"points": 6,
					"options": [
						"Instruir todos os usu√°rios a clicar em 'Avan√ßado > Continuar mesmo assim' no navegador",
						"Instalar certificado autoassinado tempor√°rio gerado no servidor",
						"Desativar HTTPS e servir o portal em HTTP (porta 80) temporariamente",
						"Solicitar renova√ß√£o expressa (fast-track) do certificado DV e aguardar emiss√£o (15-30 min)"
					],
					"correctAnswer": 3,
					"justification": "A melhor a√ß√£o √© solicitar certificado DV express (D). Certificados DV de CA comercial confi√°vel podem ser emitidos em 15-30 minutos com valida√ß√£o automatizada, restaurando confian√ßa. Op√ß√£o (A) exp√µe usu√°rios a riscos (ataques MitM) e √© impratic√°vel. (B) gera alerta de navegador id√™ntico ao expirado - n√£o resolve. (C) exp√µe credenciais em texto claro (CR√çTICO) - inaceit√°vel mesmo temporariamente. (D) balanceia velocidade e seguran√ßa."
				},
				{
					"id": "q4",
					"type": "numeric",
					"question": "Quantos dias de anteced√™ncia √© recomendado configurar alertas de expira√ß√£o de certificados para garantir tempo h√°bil de renova√ß√£o?",
					"points": 4,
					"correctAnswer": 30,
					"tolerance": 5,
					"unit": "dias",
					"justification": "Recomendado: 30 dias. Alertas em 30, 15, 7 e 3 dias fornecem m√∫ltiplos lembretes para equipes de TI. Isso permite: (1) tempo para solicitar renova√ß√£o manual, (2) resolver problemas inesperados (ex: valida√ß√£o falha), (3) evitar janelas curtas que levam a emerg√™ncias. Menos de 15 dias √© arriscado; mais de 45 dias pode ser ignorado. M√∫ltiplos alertas aumentam chance de a√ß√£o oportuna."
				}
			]
		},
		{
			"id": 3,
			"title": "Renova√ß√£o Emergencial",
			"phase": "Fase 2 - Conten√ß√£o",
			"description": "A equipe iniciou processo de renova√ß√£o emergencial do certificado via portal da CA. Escolheram m√©todo de valida√ß√£o DNS-01 (registro TXT) para maior controle. Tempo de emiss√£o previsto: 20 minutos.",
			"timeElapsed": "T+12 minutos (08:26)",
			"currentSituation": {
				"renewalStatus": "Aguardando valida√ß√£o DNS propaga√ß√£o (pendente)",
				"dnsTxtRecord": "_acme-challenge.portal.company.com IN TXT \"J3F8K2P9M7Q1...\"",
				"estimatedCompletion": "T+20 minutos (08:34)",
				"impact": "Portal continua indispon√≠vel"
			},
			"metrics": [
				{
					"type": "renewal-process",
					"title": "Status do Processo de Renova√ß√£o Emergencial",
					"data": {
						"method": "DNS-01 Challenge (ACME Protocol)",
						"validationStatus": "Aguardando propaga√ß√£o DNS (TTL: 300s)",
						"csrGenerated": "‚úÖ Certificate Signing Request (CSR) gerado com RSA 2048 bits",
						"privateKeyBackup": "‚úÖ Chave privada armazenada em /etc/ssl/private/portal.company.com.key (0400 root:root)",
						"caValidationAttempts": "3 tentativas (aguardando DNS refresh)",
						"observation": "Processo automatizado ACME aguardando que servidor DNS autorit√°rio da organiza√ß√£o propague o registro TXT de valida√ß√£o. CA est√° testando a cada 30 segundos."
					}
				},
				{
					"type": "dns-validation",
					"title": "Valida√ß√£o DNS do Registro TXT ACME",
					"data": {
						"command": "dig _acme-challenge.portal.company.com TXT +short",
						"internalDNS": "\"J3F8K2P9M7Q1...\" (‚úÖ vis√≠vel)",
						"publicDNS_8.8.8.8": "NXDOMAIN (‚ùå ainda n√£o propagado)",
						"publicDNS_1.1.1.1": "\"J3F8K2P9M7Q1...\" (‚úÖ vis√≠vel)",
						"ttl": "300 segundos (5 minutos)",
						"observation": "Propaga√ß√£o DNS em andamento. Cloudflare DNS (1.1.1.1) j√° enxerga, Google DNS (8.8.8.8) ainda em cache. CA usa m√∫ltiplos resolvers p√∫blicos. Previsto: mais 2-3 minutos para propaga√ß√£o completa."
					}
				}
			],
			"questions": [
				{
					"id": "q5",
					"type": "matching",
					"question": "Correlacione cada mecanismo de prote√ß√£o contra loops com sua descri√ß√£o correta:",
					"points": 6,
					"partialCredit": true,
					"pointsPerMatch": 2,
					"leftColumn": [
						{"id": "mech1", "text": "Spanning Tree Protocol (STP/RSTP)"},
						{"id": "mech2", "text": "Loop Guard"},
						{"id": "mech3", "text": "BPDU Guard"}
					],
					"rightColumn": [
						{"id": "a", "text": "Bloqueia portas access se receberem BPDUs, prevenindo switches n√£o autorizados"},
						{"id": "b", "text": "Detecta e bloqueia portas que param de receber BPDUs mas deveriam receber"},
						{"id": "c", "text": "Elege root bridge e bloqueia portas redundantes para criar topologia livre de loops"}
					],
					"correctMatches": [
						{"left": "mech1", "right": "c"},
						{"left": "mech2", "right": "b"},
						{"left": "mech3", "right": "a"}
					],
					"justification": "STP/RSTP √© o protocolo BASE de preven√ß√£o de loops - elege root, calcula melhor caminho, bloqueia portas redundantes. Loop Guard √© ADICIONAL - detecta falha unidirecional de links (para de receber BPDUs). BPDU Guard √© PROTE√á√ÉO de portas access - se porta access receber BPDU (indicando switch conectado), desabilita a porta automaticamente."
				},
				{
					"id": "q6",
					"type": "multiple-choice",
					"question": "A organiza√ß√£o identificou 3 certificados pr√≥ximos da expira√ß√£o (VPN: 3 dias, E-mail: 7 dias, Portal: expirado). Qual estrat√©gia de renova√ß√£o seria mais eficiente para prevenir futuros incidentes?",
					"points": 6,
					"options": [
						"Implementar renova√ß√£o manual mensal com checklist impresso",
						"Migrar para Let's Encrypt com renova√ß√£o autom√°tica via certbot/ACME",
						"Contratar suporte premium da CA com renova√ß√£o manual assistida",
						"Configurar alertas de e-mail para 30 dias antes da expira√ß√£o"
					],
					"correctAnswer": 1,
					"justification": "Let's Encrypt com automa√ß√£o ACME (B) √© a solu√ß√£o mais eficiente e moderna: certificados gratuitos de 90 dias com renova√ß√£o autom√°tica via certbot (renova aos 60 dias), elimina processos manuais, reduz custo. Op√ß√£o (A) mant√©m falha humana. (C) √© custosa e ainda manual. (D) melhora, mas alertas podem ser ignorados (como ocorreu). Automa√ß√£o via ACME + monitoramento √© best practice atual para organiza√ß√µes com m√∫ltiplos certificados."
				},
				{
					"id": "q7",
					"type": "true-false",
					"question": "Certificados wildcard (*.company.com) cobrem automaticamente subdom√≠nios de m√∫ltiplos n√≠veis, como portal.api.company.com.",
					"points": 3,
					"correctAnswer": false,
					"justification": "FALSO. Certificados wildcard cobrem apenas UM n√≠vel de subdom√≠nio. *.company.com cobre portal.company.com, api.company.com, mas N√ÉO cobre portal.api.company.com (dois n√≠veis). Para m√∫ltiplos n√≠veis, √© necess√°rio: (1) certificado com SANs expl√≠citos, (2) m√∫ltiplos wildcards (*.company.com + *.api.company.com), ou (3) certificado espec√≠fico para cada FQDN. Esta √© uma confus√£o comum que pode causar falhas de valida√ß√£o inesperadas."
				},
				{
					"id": "q8",
					"type": "numeric",
					"question": "Certificados SSL/TLS padr√£o emitidos por CAs comerciais ap√≥s setembro/2020 t√™m validade m√°xima de quantos dias?",
					"points": 4,
					"correctAnswer": 398,
					"tolerance": 2,
					"unit": "dias",
					"justification": "398 dias. Em setembro/2020, CA/Browser Forum reduziu validade m√°xima de 825 dias (27 meses) para 398 dias (~13 meses). Essa mudan√ßa visa: (1) reduzir janela de exposi√ß√£o de chaves comprometidas, (2) for√ßar atualiza√ß√µes de algoritmos criptogr√°ficos, (3) melhorar agilidade de revoga√ß√£o. Let's Encrypt usa 90 dias para for√ßar automa√ß√£o. Certificados emitidos antes de set/2020 podem ter validade maior (grandfathered)."
				}
			]
		},
		{
			"id": 4,
			"title": "Instala√ß√£o do Novo Certificado",
			"phase": "Fase 3 - Erradica√ß√£o e Recupera√ß√£o",
			"description": "Certificado DV foi emitido com sucesso e baixado do portal da CA. A equipe agora precisa instalar o certificado no servidor web (Nginx) e validar a instala√ß√£o.",
			"timeElapsed": "T+28 minutos (08:42)",
			"currentSituation": {
				"certificateIssued": "‚úÖ Emitido h√° 2 minutos (v√°lido at√© 2026-02-02)",
				"installation": "Em andamento",
				"webServerType": "Nginx 1.24.0 (Linux Ubuntu 22.04 LTS)",
				"configFile": "/etc/nginx/sites-available/portal.company.com.conf"
			},
			"metrics": [
				{
					"type": "certificate-installation",
					"title": "Procedimento de Instala√ß√£o - Configura√ß√£o Nginx",
					"data": {
						"certificateChain": "/etc/ssl/certs/portal.company.com_chain.crt (novo certificado + intermedi√°rios)",
						"privateKey": "/etc/ssl/private/portal.company.com.key (chave privada existente - reutilizada)",
						"nginxConfig": "ssl_certificate /etc/ssl/certs/portal.company.com_chain.crt;\nssl_certificate_key /etc/ssl/private/portal.company.com.key;\nssl_protocols TLSv1.2 TLSv1.3;\nssl_ciphers HIGH:!aNULL:!MD5;",
						"configTest": "nginx -t ‚Üí Syntax OK",
						"reloadCommand": "systemctl reload nginx",
						"observation": "Certificado instalado corretamente. Chain completo inclu√≠do (certificado + intermedi√°rios). Nginx recarregado sem downtime (reload graceful). Importante: chave privada foi REUTILIZADA - mesma chave do certificado anterior."
					}
				},
				{
					"type": "ssl-validation",
					"title": "Valida√ß√£o P√≥s-Instala√ß√£o com SSL Labs",
					"data": {
						"overallGrade": "A",
						"certificateValidity": "‚úÖ V√°lido at√© 2026-02-02 23:59:59 UTC",
						"chainIssues": "‚úÖ Nenhum - cadeia completa presente",
						"protocol": "TLS 1.3, TLS 1.2 habilitados (TLS 1.0/1.1 desabilitados) ‚úÖ",
						"keyExchange": "ECDHE (Perfect Forward Secrecy) ‚úÖ",
						"cipherStrength": "256 bits (AES-256-GCM) ‚úÖ",
						"vulnerabilities": "Nenhuma (n√£o vulner√°vel a BEAST, CRIME, Heartbleed, POODLE) ‚úÖ",
						"observation": "Configura√ß√£o segura. Grade A confirma que certificado √© confi√°vel, protocolos modernos habilitados e sem vulnerabilidades conhecidas. Portal totalmente restaurado."
					}
				}
			],
			"questions": [
				{
					"id": "q9",
					"type": "ordering",
					"question": "Ordene os passos corretos para instala√ß√£o segura do certificado SSL/TLS renovado em um servidor web:",
					"points": 6,
					"partialCredit": false,
					"items": [
						{"id": "step1", "text": "Fazer backup do certificado e chave privada anteriores"},
						{"id": "step2", "text": "Baixar certificado novo e arquivos intermedi√°rios da CA"},
						{"id": "step3", "text": "Concatenar certificado + intermedi√°rios em ordem correta (chain)"},
						{"id": "step4", "text": "Atualizar caminho do certificado na configura√ß√£o do servidor web"},
						{"id": "step5", "text": "Testar sintaxe da configura√ß√£o (nginx -t, apache2ctl configtest)"},
						{"id": "step6", "text": "Recarregar servidor web (reload) e validar com OpenSSL/SSL Labs"}
					],
					"correctOrder": ["step1", "step2", "step3", "step4", "step5", "step6"],
					"justification": "Ordem correta: (1) Backup primeiro (seguran√ßa - revers√£o se algo falhar), (2) Download certificado e intermedi√°rios, (3) Concatenar chain (cert + intermedi√°rios na ordem), (4) Atualizar config do servidor, (5) Testar sintaxe ANTES de reload (evita downtime), (6) Reload e valida√ß√£o. Pular backup (step1) ou teste de sintaxe (step5) s√£o erros comuns que causam downtime desnecess√°rio."
				},
				{
					"id": "q10",
					"type": "multiple-choice",
					"question": "Durante a instala√ß√£o, a equipe reutilizou a chave privada do certificado anterior. Qual √© a implica√ß√£o de seguran√ßa desta pr√°tica?",
					"points": 5,
					"options": [
						"√â uma vulnerabilidade cr√≠tica - chave privada deve ser regenerada a cada renova√ß√£o",
						"√â aceit√°vel e comum - chave privada pode ser reutilizada indefinidamente se n√£o comprometida",
						"√â aceit√°vel para renova√ß√µes de curto prazo (<1 ano), mas recomenda-se regenerar periodicamente",
						"√â obrigat√≥rio regenerar chave privada - CAs n√£o emitem certificados para chaves reutilizadas"
					],
					"correctAnswer": 2,
					"justification": "Reutilizar chave privada √© aceit√°vel para renova√ß√µes frequentes, mas best practice (C) recomenda regenerar periodicamente (anualmente ou a cada 2-3 renova√ß√µes) para: (1) reduzir janela de exposi√ß√£o caso chave seja comprometida, (2) permitir rota√ß√£o de algoritmos (ex: RSA 2048‚Üí4096, EC 256‚Üí384). Op√ß√£o (A) √© exagerada - n√£o √© vulnerabilidade se chave est√° segura. (B) ignora hygiene criptogr√°fica. (D) √© falsa - CAs aceitam CSRs com chaves reutilizadas."
				},
				{
					"id": "q11",
					"type": "true-false",
					"question": "Navegadores confiam automaticamente em certificados cujo emissor (CA) est√° na lista de autoridades raiz confi√°veis do sistema operacional, sem necessidade de instala√ß√£o manual.",
					"points": 3,
					"correctAnswer": true,
					"justification": "VERDADEIRO. Navegadores modernos (Chrome, Firefox, Edge, Safari) utilizam lista de Certificate Authorities (CAs) raiz confi√°veis mantida pelo sistema operacional (Windows Trust Store, macOS Keychain, Linux ca-certificates) ou pr√≥pria (Firefox). Certificados emitidos por essas CAs (Sectigo, DigiCert, Let's Encrypt, GlobalSign) s√£o automaticamente confi√°veis. Certificados autoassinados ou de CAs privadas requerem instala√ß√£o manual no trust store, gerando alertas de navegador."
				}
			]
		},
		{
			"id": 5,
			"title": "P√≥s-Incidente e Melhorias de Processo",
			"phase": "Fase 4 - P√≥s-Incidente",
			"description": "Portal restaurado com sucesso √†s 08:48 (34 minutos de downtime). A equipe agora precisa implementar melhorias de processo para prevenir recorr√™ncia e renovar os certificados pr√≥ximos da expira√ß√£o (VPN e E-mail).",
			"timeElapsed": "T+34 minutos (08:48 - incidente resolvido)",
			"currentSituation": {
				"portalStatus": "‚úÖ Operacional - certificado v√°lido at√© 2026-02-02",
				"downtime": "34 minutos (impacto: ~300 usu√°rios internos + clientes externos)",
				"pendingRenewals": "vpn.company.com (3 dias), mail.company.com (7 dias)",
				"impact": "Nenhum - servi√ßo completamente restaurado"
			},
			"questions": [
				{
					"id": "q12",
					"type": "multiple-choice",
					"question": "Qual ferramenta/abordagem de monitoramento seria mais eficaz para prevenir futuros incidentes de expira√ß√£o de certificados?",
					"points": 6,
					"options": [
						"Planilha Excel compartilhada com datas de expira√ß√£o e alertas de calend√°rio",
						"Script cron di√°rio executando 'openssl s_client' + envio de e-mail se < 30 dias",
						"Sistema de monitoramento (Zabbix/Nagios) com check SSL/TLS e alertas escalonados (90/60/30/15 dias)",
						"Depender dos e-mails de alerta da CA enviados para admin@company.com"
					],
					"correctAnswer": 2,
					"justification": "Sistema de monitoramento dedicado (C) √© solu√ß√£o profissional: checks automatizados a cada hora, alertas escalonados (90/60/30/15/7 dias), m√∫ltiplos canais (e-mail/SMS/Slack), dashboards centralizados, hist√≥rico. Op√ß√£o (A) depende de processo manual propenso a falhas. (B) √© melhor que nada mas limitada (cron pode falhar, e-mail pode ser ignorado). (D) j√° falhou neste incidente. (C) oferece visibilidade centralizada + automa√ß√£o + redund√¢ncia de alertas."
				},
				{
					"id": "q13",
					"type": "matching",
					"question": "Conecte cada tipo de licen√ßa de conte√∫do ao seu n√≠vel de permiss√£o de distribui√ß√£o:",
					"points": 6,
					"partialCredit": true,
					"pointsPerMatch": 2,
					"leftColumn": [
						{"id": "cc-by", "text": "Creative Commons BY (CC-BY)"},
						{"id": "cc-by-nc-nd", "text": "Creative Commons BY-NC-ND"},
						{"id": "copyright", "text": "Copyright ¬© Todos os Direitos Reservados"}
					],
					"rightColumn": [
						{"id": "a", "text": "Redistribui√ß√£o livre permitida (inclusive comercial), desde que cr√©dito ao autor seja dado"},
						{"id": "b", "text": "Apenas visualiza√ß√£o pessoal - reprodu√ß√£o e distribui√ß√£o proibidas sem autoriza√ß√£o expressa"},
						{"id": "c", "text": "Uso n√£o-comercial permitido, mas modifica√ß√µes e redistribui√ß√£o comercial proibidas"}
					],
					"correctMatches": [
						{"left": "cc-by", "right": "a"},
						{"left": "cc-by-nc-nd", "right": "c"},
						{"left": "copyright", "right": "b"}
					],
					"justification": "CC-BY (‚Üî a): licen√ßa mais permissiva - uso livre (comercial ok), exige apenas atribui√ß√£o. CC-BY-NC-ND (‚Üî c): mais restritiva - Non-Commercial (sem fins lucrativos) + No-Derivatives (sem modifica√ß√µes). Copyright padr√£o (‚Üî b): todos direitos reservados pelo titular, qualquer uso requer autoriza√ß√£o. Espectro: Dom√≠nio P√∫blico (mais livre) ‚Üí CC-BY ‚Üí CC-BY-SA ‚Üí CC-BY-NC ‚Üí CC-BY-NC-ND ‚Üí Copyright (mais restritivo)."
				},
				{
					"id": "q14",
					"type": "multiple-choice",
					"question": "A organiza√ß√£o decidiu migrar para Let's Encrypt com renova√ß√£o autom√°tica via certbot. Qual √© a principal DESVANTAGEM desta abordagem comparada a CA comercial tradicional?",
					"points": 5,
					"options": [
						"Let's Encrypt n√£o √© confi√°vel - navegadores exibem alertas de seguran√ßa",
						"Certificados de 90 dias requerem renova√ß√£o frequente - maior depend√™ncia de automa√ß√£o",
						"Let's Encrypt n√£o emite certificados wildcard (*.dominio.com)",
						"Algoritmos criptogr√°ficos do Let's Encrypt s√£o mais fracos (1024 bits)"
					],
					"correctAnswer": 1,
					"justification": "Paradoxo do filtro: detec√ß√£o proativa = 'actual knowledge' (option B). Se sistema detecta infra√ß√£o e provedor N√ÉO remove imediatamente, tribunal pode considerar que provedor tinha conhecimento e foi negligente, PERDENDO Safe Harbor (Viacom v. YouTube debate este tema). Safe Harbor protege provedores 'passivos' que respondem a notifica√ß√µes, n√£o aqueles que monitoram ativamente. Solu√ß√£o: usar filtro para flagging + revis√£o humana r√°pida. Op√ß√£o (A) √© custo, n√£o risco legal. (C) √© risco real mas mitig√°vel. (D) √© falsa - an√°lise de hash n√£o √© dado pessoal."
				},
				{
					"id": "q15",
					"type": "true-false",
					"question": "Implementar renova√ß√£o autom√°tica via ACME (certbot/Let's Encrypt) elimina a necessidade de monitoramento de expira√ß√£o de certificados.",
					"points": 3,
					"correctAnswer": false,
					"justification": "FALSO. Embora automa√ß√£o via ACME reduza risco de expira√ß√£o, monitoramento cont√≠nuo ainda √© necess√°rio para: (1) detectar falhas na renova√ß√£o autom√°tica (ex: problemas de rede, mudan√ßas DNS), (2) alertar sobre certificados pr√≥ximos da expira√ß√£o (backup), (3) garantir conformidade com pol√≠ticas internas. Automa√ß√£o + monitoramento formam defesa em profundidade. Depender exclusivamente de automa√ß√£o pode levar a falhas n√£o detectadas."
				},
				{
					"id": "q16",
					"type": "multiple-choice",
					"question": "Durante o post-mortem, identificou-se que e-mails de alerta da CA eram enviados para admin@company.com (caixa compartilhada raramente checada). Qual seria a melhor solu√ß√£o para garantir que alertas sejam recebidos?",
					"points": 5,
					"options": [
						"Configurar redirecionamento de admin@company.com para CEO da empresa",
						"Atualizar contato na CA para lista de distribui√ß√£o da equipe de infraestrutura + configurar monitoramento independente",
						"Contratar servi√ßo de SMS da CA para envio de alertas por mensagem de texto",
						"Solicitar √† CA que aumente frequ√™ncia de alertas para di√°rio"
					],
					"correctAnswer": 1,
					"justification": "Solu√ß√£o adequada (B) combina m√∫ltiplas camadas: (1) atualizar contato CA para lista de distribui√ß√£o (infra@company.com) com m√∫ltiplos respons√°veis, (2) implementar monitoramento INDEPENDENTE da CA (n√£o depender exclusivamente de terceiros). Op√ß√£o (A) sobrecarrega CEO com detalhes t√©cnicos. (C) melhora, mas tem custo e ainda depende da CA. (D) n√£o resolve problema - alertas di√°rios causam fadiga de alerta. Redund√¢ncia (CA + monitoramento pr√≥prio) √© best practice."
				}
			]
		}
	],
	"evaluation": {
		"totalPoints": 92,
		"passingScore": 60,
		"gradingScale": [
			{
				"min": 85,
				"max": 100,
				"grade": "Excelente",
				"description": "Dom√≠nio completo de PKI, gest√£o de certificados SSL/TLS e processos de renova√ß√£o emergencial"
			},
			{
				"min": 70,
				"max": 84,
				"grade": "Bom",
				"description": "Compreens√£o s√≥lida de certificados digitais com pequenas lacunas em automa√ß√£o ou tipos de certificado"
			},
			{
				"min": 60,
				"max": 69,
				"grade": "Satisfat√≥rio",
				"description": "Compreens√£o b√°sica suficiente, requer aprofundamento em PKI e m√©todos de valida√ß√£o ACME"
			},
			{
				"min": 40,
				"max": 59,
				"grade": "Insuficiente",
				"description": "Lacunas significativas em conhecimento de certificados digitais e processos de renova√ß√£o"
			},
			{
				"min": 0,
				"max": 39,
				"grade": "Inadequado",
				"description": "Conhecimento m√≠nimo sobre PKI - recomenda-se treinamento formal em seguran√ßa e criptografia"
			}
		]
	},
	"facilitatorNotes": [
		"Apresentar informa√ß√µes progressivamente, simulando descoberta natural durante troubleshooting",
		"Permitir 3-5 minutos de discuss√£o entre participantes antes de cada resposta",
		"Fazer perguntas orientadoras: 'Qual √© a diferen√ßa entre DV, OV e EV?', 'Por que certificados t√™m validade limitada?'",
		"Enfatizar import√¢ncia de PREVEN√á√ÉO atrav√©s de monitoramento proativo e automa√ß√£o",
		"Se grupo n√£o tem experi√™ncia com PKI, explicar conceitos de CA, cadeia de confian√ßa antes da Rodada 2",
		"Manter neutralidade t√©cnica - n√£o fornecer respostas diretas, apenas guiar racioc√≠nio",
		"Controlar tempo: Rodada 1 (5 min), Rodadas 2-4 (10 min cada), Rodada 5 (8 min)",
		"Mediar debates sobre trade-offs (custo vs. automa√ß√£o, DV vs. OV vs. EV)",
		"Ap√≥s exerc√≠cio: revisar gabarito, discutir implementa√ß√£o de Let's Encrypt/certbot",
		"Coletar feedback sobre realismo do cen√°rio e ajustes necess√°rios",
		"Documentar insights para melhorar processos de gest√£o de certificados"
	],
	"technicalReferences": [
		{
			"title": "RFC 8555 - Automatic Certificate Management Environment (ACME)",
			"url": "https://www.rfc-editor.org/rfc/rfc8555"
		},
		{
			"title": "RFC 5280 - Internet X.509 Public Key Infrastructure Certificate",
			"url": "https://www.rfc-editor.org/rfc/rfc5280"
		},
		{
			"title": "CA/Browser Forum - Baseline Requirements for SSL/TLS Certificates",
			"url": "https://cabforum.org/baseline-requirements-documents/"
		},
		{
			"title": "Let's Encrypt - How It Works (ACME Protocol)",
			"url": "https://letsencrypt.org/how-it-works/"
		},
		{
			"title": "SSL Labs - SSL/TLS Best Practices",
			"url": "https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices"
		},
		{
			"title": "Mozilla SSL Configuration Generator",
			"url": "https://ssl-config.mozilla.org/"
		},
		{
			"title": "Certbot Documentation - Automated Certificate Management",
			"url": "https://eff-certbot.readthedocs.io/"
		}
	]
}
